<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Decryption Tool</title>
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
   </head>
   <body>
      <div class="container mt-5">
         <h1>Decryption Tool</h1>
         <form method="POST" enctype="multipart/form-data">
            <div class="form-group">
               <label for="input_file">Encrypted File:</label>
               <input type="file" id="input_file" name="input_file" class="form-control" required>
            </div>
            <div class="form-group">
               <label for="password_file">Password File:</label>
               <input type="file" id="password_file" name="password_file" class="form-control" required>
            </div>
            <button type="submit" class="btn btn-primary">Start Decryption</button>
            <button type="button" onclick="location.reload()" class="btn btn-secondary">Refresh Page</button>
            <button type="button" onclick="saveTextToFile()" class="btn btn-secondary">Save to File</button>
         </form>

         <hr>

         {% with messages = get_flashed_messages(with_categories=true) %}
         {% if messages %}
            {% for category, message in messages %}
               <div class="alert alert-{{ category }} mt-2">
                  {{ message }}
               </div>
            {% endfor %}
         {% endif %}
         {% endwith %}

         <script>
            function saveTextToFile() {
               const text = "Decryption attempts: {{ attempt_count }}";  // Replace with dynamic text as needed
               const blob = new Blob([text], { type: 'text/plain' });
               const link = document.createElement("a");
               link.href = URL.createObjectURL(blob);
               link.download = "decryption_log.txt";
               link.click();
            }
         </script>
      </div>
   </body>
</html>